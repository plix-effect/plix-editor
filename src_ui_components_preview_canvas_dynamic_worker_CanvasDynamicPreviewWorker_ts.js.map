{"version":3,"sources":["webpack://@plix-effect/editor/./src/ui/components/preview/canvas/dynamic/preview-field/PlixCanvasField.ts","webpack://@plix-effect/editor/./src/ui/components/preview/canvas/dynamic/worker/CanvasDynamicPreviewWorker.ts","webpack://@plix-effect/editor/./src/ui/components/preview/canvas/dynamic/worker/CanvasFieldRenderer.ts","webpack://@plix-effect/editor/webpack/bootstrap","webpack://@plix-effect/editor/webpack/runtime/compat get default export","webpack://@plix-effect/editor/webpack/runtime/define property getters","webpack://@plix-effect/editor/webpack/runtime/ensure chunk","webpack://@plix-effect/editor/webpack/runtime/get javascript chunk filename","webpack://@plix-effect/editor/webpack/runtime/get mini-css chunk filename","webpack://@plix-effect/editor/webpack/runtime/global","webpack://@plix-effect/editor/webpack/runtime/hasOwnProperty shorthand","webpack://@plix-effect/editor/webpack/runtime/make namespace object","webpack://@plix-effect/editor/webpack/runtime/startup chunk dependencies","webpack://@plix-effect/editor/webpack/runtime/publicPath","webpack://@plix-effect/editor/webpack/runtime/importScripts chunk loading","webpack://@plix-effect/editor/webpack/startup"],"names":[],"mappings":"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","file":"src_ui_components_preview_canvas_dynamic_worker_CanvasDynamicPreviewWorker_ts.js","sourcesContent":["import {HSLAColor, PlixColor, RGBAColor} from \"@plix-effect/core/types\";\nimport {hslaToRgba} from \"@plix-effect/core/color\";\nimport {FieldElement, FieldElementLine, FieldElementPixel} from \"./PreviewFieldElement\";\n\n\nexport interface PreviewFieldConfig {\n    width: number,\n    height: number,\n    elements: FieldElement[],\n}\n\nconst TWO_PI = 2 * Math.PI;\n\nexport type OffscreenCanvasGeneric = {\n    canvas: OffscreenCanvas\n    ctx: OffscreenCanvasRenderingContext2D\n}\nexport type RegularCanvasGeneric = {\n    canvas: HTMLCanvasElement\n    ctx: CanvasRenderingContext2D\n}\nexport type CanvasGeneric =\n    | OffscreenCanvasGeneric\n    | RegularCanvasGeneric\n;\n\nconst contourColor = \"#444\";\n\nexport const DEFAULT_PREVIEW_FIELD_CONFIG: PreviewFieldConfig = {\n    width: 1000,\n    height: 100,\n    elements: Array.from({length: 20}).map((_, i) => {\n        const size = 25;\n        return {type: \"pixel\", props: {shape: i<10 ? \"circle\" : \"square\", size: size,}, geometry: [40 + i * (size + 10), 40]}\n    })\n}\n\nexport class PlixCanvasField<T extends CanvasGeneric> {\n\n    private cfg: PreviewFieldConfig\n    private canvas: T['canvas'];\n    private ctx: T['ctx'];\n\n    constructor(canvas: T['canvas']) {\n        this.canvas = canvas;\n        this.ctx = canvas.getContext(\"2d\");\n    }\n\n    setConfig(cfg: PreviewFieldConfig) {\n        this.cfg = cfg;\n        this.canvas.height = cfg.height;\n        this.canvas.width = cfg.width;\n    }\n\n    getConfig() {\n        return this.cfg;\n    }\n\n    get elementsCount() {\n        return this.cfg.elements.length;\n    }\n\n\n\n    public drawElementFromConfig(index: number, color?: RGBAColor, outlineColor = contourColor): void {\n        const element = this.cfg.elements[index];\n        this.drawElement(element, color, outlineColor);\n    }\n\n    public drawElement(element: FieldElement, color?: RGBAColor, outlineColor = contourColor): void {\n        if (element.type === \"line\") this.drawLine(element, color, outlineColor);\n        else if (element.type === \"pixel\") this.drawPixel(element, color, outlineColor);\n    }\n\n    public resetDraw() {\n        this.ctx.fillStyle = \"black\";\n        this.ctx.fillRect(0,0, this.canvas.width, this.canvas.height);\n        const elements = this.cfg.elements;\n        for (let i = 0; i < elements.length; i++) {\n            this.drawElementFromConfig(i, null);\n        }\n    }\n\n    public drawLine (lineInfo: FieldElementLine, color?: RGBAColor, outlineColor = contourColor) {\n        console.warn(\"drawLine not implemented\")\n    }\n\n    public drawPixel(pixelInfo: FieldElementPixel, color?: RGBAColor, outlineColor = contourColor) {\n        const [x,y] = pixelInfo.geometry;\n        const ctx = this.ctx;\n        const size = pixelInfo.props.size;\n\n        function getSizeGain() {\n            const {r,g,b,a} = color;\n            const lum = 0.3 * r*a + 0.59 * g*a + 0.11 * b*a; // luminosity value: 0-255\n            const sizeGain = Math.min(lum/128, 1);\n            return sizeGain;\n        }\n\n        function drawSquare() {\n            ctx.strokeStyle = outlineColor;\n            const halfSize = size/2;\n            ctx.setLineDash([halfSize/2, halfSize/2]);\n            ctx.strokeRect(x-halfSize-1, y-halfSize-1, size+2, size+2)\n            if (!color) return;\n            const sizeGain = getSizeGain();\n            const colorSize = sizeGain*size;\n            const halfColorSize = colorSize/2;\n            const {r,g,b,a} = color;\n            ctx.fillStyle = `rgba(${r},${g},${b},${a})`;\n            ctx.fillRect(x-halfColorSize, y-halfColorSize, colorSize, colorSize)\n        }\n\n        function drawCircle() {\n            ctx.beginPath();\n            const radius = Math.floor(size/2)\n            ctx.setLineDash([radius/2, radius/2]);\n            ctx.arc(x, y, radius+1, 0, TWO_PI);\n            ctx.strokeStyle = outlineColor;\n            ctx.stroke();\n            if (!color) return;\n            const {r,g,b,a} = color;\n            const sizeGain = getSizeGain()\n            const innerRadius = Math.round(Math.sqrt(sizeGain)*radius);\n            ctx.beginPath();\n            ctx.arc(x, y, innerRadius, 0, TWO_PI);\n            ctx.fillStyle = `rgba(${r},${g},${b},${a})`;\n            ctx.fill();\n        }\n\n        if (pixelInfo.props.shape === \"circle\") {\n            drawCircle();\n        } else {\n            drawSquare();\n        }\n    }\n\n    public getElementAtPos(x: number, y: number): [FieldElement, number] {\n        const index = this.cfg.elements.findIndex((value, i) => {\n            if (value.type === \"pixel\") {\n                const size = value.props.size;\n                const halfSize = size/2;\n                const [eX, eY] = value.geometry;\n                const dx = eX -x;\n                const dy = eY -y;\n                if (value.props.shape === \"circle\") {\n                    return Math.sqrt(dx*dx + dy*dy) <= halfSize;\n                } else {\n                    return Math.abs(dx) <= halfSize && Math.abs(dy) <= halfSize\n                }\n            }\n            return false;\n        });\n        if (index == -1) return [null, -1];\n        return [this.cfg.elements[index], index];\n    }\n}","import {PlaybackStatus} from \"../../../../editor/PlaybackContext\";\nimport {PlixEffectJsonData} from \"@plix-effect/core/dist/types/parser\";\nimport {PlixJsonData, PlixProfile} from \"@plix-effect/core/types/parser\";\nimport {PreviewFieldConfig, PlixCanvasField, OffscreenCanvasGeneric} from \"../preview-field/PlixCanvasField\";\nimport parseRender from \"@plix-effect/core/dist/parser\";\nimport * as effectConstructorMap from \"@plix-effect/core/effects\";\nimport * as filterConstructorMap from \"@plix-effect/core/filters\";\nimport {CanvasFieldRenderer} from \"./CanvasFieldRenderer\";\n\n\ndeclare const self: Worker;\n\n// TYPES\ninterface RenderMsgData {\n    render: PlixEffectJsonData,\n    track: PlixJsonData,\n    profileName: string|null,\n    duration: number\n}\nexport type CvsDynPreviewInMsg =\n    | CvsDynPreviewInMsgInit\n    | CvsDynPreviewInMsgSyncPerformance\n    | CvsDynPreviewInMsgChangePlayback\n    | CvsDynPreviewInMsgRenderData\n    | CvsDynPreviewInMsgChangeField\n;\n\nexport interface CvsDynPreviewInMsgInit {\n    type: \"init\",\n    canvas: OffscreenCanvas\n    performanceValue: number\n}\n\nexport interface CvsDynPreviewInMsgSyncPerformance {\n    type: \"sync_performance\",\n    value: number\n}\n\nexport interface CvsDynPreviewInMsgChangePlayback {\n    type: \"change_playback\",\n    playFromStamp: number,\n    status: PlaybackStatus,\n    pauseTime: number | null,\n    rate: number | null\n}\nexport interface CvsDynPreviewInMsgRenderData {\n    type: \"render\",\n    data: RenderMsgData\n}\nexport interface CvsDynPreviewInMsgChangeField {\n    type: \"field\",\n    config: PreviewFieldConfig\n}\nexport type CvsDynPreviewOutMsg =\n    | CvsDynPreviewOutMsgDeps\n;\nexport interface CvsDynPreviewOutMsgDeps {\n    type: \"deps\"\n    deps: [string[], string[]]\n};\n\n// Variables\nlet field: PlixCanvasField<OffscreenCanvasGeneric>;\nlet renderer: CanvasFieldRenderer;\nlet performanceOffset: number;\nlet lastPauseTime: number|null;\n\n// Handlers\nconst syncPerformance = (globalValue) => {\n    performanceOffset = globalValue - performance.now()\n}\n\nconst handleInitMsg = (msg: CvsDynPreviewInMsgInit) => {\n    field = new PlixCanvasField<OffscreenCanvasGeneric>(msg.canvas);\n    renderer = new CanvasFieldRenderer(field);\n    syncPerformance(msg.performanceValue);\n}\nconst handleSyncPerformanceMsg = (msg: CvsDynPreviewInMsgSyncPerformance) => {\n    syncPerformance(msg.value);\n}\nconst handleChangePlaybackMsg = (msg: CvsDynPreviewInMsgChangePlayback) => {\n    const status = msg.status;\n    if (renderer.readyForRendering) {\n        if (status === \"play\") {\n            lastPauseTime = null;\n            renderer.startRendering(msg.playFromStamp-performanceOffset, msg.rate);\n        } else if (status === \"pause\") {\n            lastPauseTime = msg.pauseTime;\n            renderer.stopRendering();\n            renderer.renderTime(msg.pauseTime);\n        } else if (status === \"stop\") {\n            lastPauseTime = null;\n            renderer.stopRendering();\n            field.resetDraw();\n        }\n    }\n}\n\nconst handleRenderMsg = (msg: CvsDynPreviewInMsgRenderData) => {\n    const renderData = msg.data\n    const effectData = renderData.render;\n    const track = renderData.track;\n    const duration = renderData.duration;\n    const profileName = renderData.profileName;\n\n    const parsedData = parseRender(effectData, track.effects, track.filters, effectConstructorMap, filterConstructorMap, track.profiles, profileName);\n    const effectKeys = Object.keys(parsedData.effectsMap).sort();\n    const filterKeys = Object.keys(parsedData.filtersMap).sort();\n    const depsMessage: CvsDynPreviewOutMsgDeps = { type: \"deps\", deps: [effectKeys, filterKeys]}\n    self.postMessage(depsMessage, []);\n\n    renderer.setParsedData(parsedData);\n    renderer.setDuration(duration);\n    if (lastPauseTime != null) renderer.renderTime(lastPauseTime);\n}\n\nconst handleChangeFieldMsg = (msg: CvsDynPreviewInMsgChangeField) => {\n    field.setConfig(msg.config);\n    if (renderer) renderer.renderTime(lastPauseTime ?? null);\n}\n\n// On message\nonmessage = (event) => {\n    const data = event.data as CvsDynPreviewInMsg\n    if (data.type === \"init\") {\n        handleInitMsg(data);\n    } else if (data.type === \"sync_performance\") {\n        handleSyncPerformanceMsg(data);\n    } else if (data.type === \"change_playback\") {\n        handleChangePlaybackMsg(data);\n    } else if (data.type === \"render\") {\n        handleRenderMsg(data)\n    } else if (data.type === \"field\") {\n        handleChangeFieldMsg(data);\n    }\n}","import {PlixCanvasField} from \"../preview-field/PlixCanvasField\";\nimport {BLACK, toRgba} from \"@plix-effect/core/color\";\nimport parseRender from \"@plix-effect/core/dist/parser\";\n\n\nexport class CanvasFieldRenderer {\n\n    private field: PlixCanvasField<any>;\n    private parsedData: ReturnType<typeof parseRender>;\n    private duration: number\n\n    constructor(field: PlixCanvasField<any>) {\n        this.field = field;\n    }\n\n    setParsedData(data: ReturnType<typeof parseRender>) {\n        this.parsedData = data;\n    }\n\n    setDuration(value: number) {\n        this.duration = value;\n    }\n\n    renderTime(time: number|null) {\n        this.field.resetDraw();\n        if (!this.parsedData) return;\n        if (time == null) return;\n        const count = this.field.elementsCount;\n        const line = this.parsedData.effect(time, this.duration);\n        for (let i = 0; i < count; i++) {\n            const mod = line(i, count);\n            const color = mod(BLACK);\n            this.field.drawElementFromConfig(i, toRgba(color));\n        }\n    }\n\n    private currentRenderProcessId?: Symbol = null;\n    public startRendering(playFromTimestamp, playbackRate) {\n        const currentRafProcessId = this.currentRenderProcessId = Symbol();\n        const doRender = () => {\n            if (currentRafProcessId !== this.currentRenderProcessId) return;\n            requestAnimationFrame(doRender);\n            const time = performance.now() - playFromTimestamp;\n            this.renderTime(time * playbackRate);\n        }\n        doRender();\n    }\n\n    public stopRendering() {\n        this.currentRenderProcessId = null;\n    }\n\n    public get rendering() {return this.currentRenderProcessId != null}\n    public get readyForRendering() {return this.parsedData != null && this.duration != null}\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module\n\t__webpack_require__(\"./src/ui/components/preview/canvas/dynamic/worker/CanvasDynamicPreviewWorker.ts\");\n\t// This entry module used 'exports' so it can't be inlined\n};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".js\";\n};","// This function allow to reference all chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"style/style-\" + chunkId + \".css\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\treturn __webpack_require__.e(\"vendors-node_modules_plix-effect_core_dist_effects_index_js-node_modules_plix-effect_core_dis-eb2327\").then(next);\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t\"src_ui_components_preview_canvas_dynamic_worker_CanvasDynamicPreviewWorker_ts\": 1\n};\n\n// importScripts chunk loading\nvar chunkLoadingCallback = (data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\timportScripts(\"\" + __webpack_require__.u(chunkId));\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunk_plix_effect_editor\"] = self[\"webpackChunk_plix_effect_editor\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = chunkLoadingCallback;\n\n// no HMR\n\n// no HMR manifest","// run startup\nreturn __webpack_require__.x();\n"],"sourceRoot":""}